# -*- makefile -*-

LIBUTL/     :=$(call MakePath,$/../libutil/)
LIBBIO/     :=$(call MakePath,$/../libbio/)
LIBSEQ/     :=$(call MakePath,$/../libseq/)
LIBMERYL/   :=$(call MakePath,$/../libmeryl/)
LIBKMER/    :=$(call MakePath,$/../libkmer/)

merylsrc := $/args.C \
            $/binaryOp.C \
            $/build.C \
            $/build-threads.C \
            $/dump.C \
            $/estimate.C \
            $/merge.C \
            $/unaryOp.C

#  Removed m.C from SRCS. and m from EXES -- what's it do??

#  meryl.H is exported only for celera-assembler.

$/.CXX_SRCS   := ${merylsrc} $/meryl.C $/asmMerQC.C $/mapMers.C $/mapMers-depth.C $/maskMers.C
$/.CXX_INCS   := $/meryl.H
$/.CXX_LIBS   := $/libmerylguts.a
$/.CXX_EXES   := $/meryl $/asmMerQC $/mapMers $/mapMers-depth $/testPositionBias $/maskMers
$/.CLEAN      := $/*.o

$/libmerylguts.a : ${merylsrc:.C=.o}

$/meryl            : $/meryl.o      $/libmerylguts.a            ${LIBMERYL/}libmeryl.a ${LIBSEQ/}libseq.a ${LIBBIO/}libbio.a ${LIBUTL/}libutil.a
$/asmMerQC         : $/asmMerQC.o                               ${LIBMERYL/}libmeryl.a ${LIBSEQ/}libseq.a ${LIBBIO/}libbio.a ${LIBUTL/}libutil.a
$/mapMers          : $/mapMers.o           ${LIBKMER/}libkmer.a ${LIBMERYL/}libmeryl.a ${LIBSEQ/}libseq.a ${LIBBIO/}libbio.a ${LIBUTL/}libutil.a
$/mapMers-depth    : $/mapMers-depth.o     ${LIBKMER/}libkmer.a ${LIBMERYL/}libmeryl.a ${LIBSEQ/}libseq.a ${LIBBIO/}libbio.a ${LIBUTL/}libutil.a
$/m                : $/m.o                 ${LIBKMER/}libkmer.a ${LIBMERYL/}libmeryl.a ${LIBSEQ/}libseq.a ${LIBBIO/}libbio.a ${LIBUTL/}libutil.a
$/testPositionBias : $/testPositionBias.o  ${LIBKMER/}libkmer.a ${LIBMERYL/}libmeryl.a ${LIBSEQ/}libseq.a ${LIBBIO/}libbio.a ${LIBUTL/}libutil.a
$/maskMers         : $/maskMers.o          ${LIBKMER/}libkmer.a ${LIBMERYL/}libmeryl.a ${LIBSEQ/}libseq.a ${LIBBIO/}libbio.a ${LIBUTL/}libutil.a

$(eval $/%.d $/%.o:  CXXFLAGS+=-I${LIBMERYL/} -I${LIBKMER/} -I${LIBBIO/} -I${LIBSEQ/} -I${LIBUTL/})

$/%.d:  ${LIBBIO/}alphabet.h
